"use strict";
self["webpackHotUpdatenode_template"]("main",{

/***/ "./app/index.js":
/*!**********************!*\
  !*** ./app/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var utils_polyfill__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/polyfill */ "./app/utils/polyfill.js");
/* harmony import */ var utils_scroll__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/scroll */ "./app/utils/scroll.js");
/* harmony import */ var utils_scroll__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(utils_scroll__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var utils_sw__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! utils/sw */ "./app/utils/sw.js");
/* harmony import */ var utils_sw__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(utils_sw__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var auto_bind__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! auto-bind */ "./node_modules/auto-bind/index.js");
/* harmony import */ var fontfaceobserver_fontfaceobserver_standalone__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fontfaceobserver/fontfaceobserver.standalone */ "./node_modules/fontfaceobserver/fontfaceobserver.standalone.js");
/* harmony import */ var fontfaceobserver_fontfaceobserver_standalone__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fontfaceobserver_fontfaceobserver_standalone__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var stats_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! stats.js */ "./node_modules/stats.js/build/stats.min.js");
/* harmony import */ var stats_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(stats_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var lodash_each__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash/each */ "./node_modules/lodash/each.js");
/* harmony import */ var lodash_each__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash_each__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var classes_Detection__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! classes/Detection */ "./app/classes/Detection.js");
/* harmony import */ var pages_About__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! pages/About */ "./app/pages/About/index.js");
/* harmony import */ var pages_Home__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! pages/Home */ "./app/pages/Home/index.js");
/* harmony import */ var components_Canvas__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! components/Canvas */ "./app/components/Canvas/index.js");
/* harmony import */ var components_Preloader__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! components/Preloader */ "./app/components/Preloader.js");












class App {
  constructor() {
    if ( true && window.location.search.indexOf("fps") > -1) {
      this.createStats();
    }
    (0,auto_bind__WEBPACK_IMPORTED_MODULE_3__["default"])(this);
    this.content = document.querySelector(".content");
    this.template = this.content.dataset.template;
    this.createPreloader();
    this.createCanvas();
    this.pages = new Map();
    this.pages.set("about", new pages_About__WEBPACK_IMPORTED_MODULE_8__["default"]());
    this.pages.set("home", new pages_Home__WEBPACK_IMPORTED_MODULE_9__["default"]());
    this.page = this.pages.get(this.template);
    this.page.create();
    this.page.show();
    this.addEventListeners();
    this.addLinksEventsListeners();
  }
  createPreloader() {
    this.preloader = new components_Preloader__WEBPACK_IMPORTED_MODULE_11__["default"]();
    this.preloader.on("complete", this.onPreloaded);
  }
  onPreloaded() {
    this.onResize();
    this.createAnalytics();
    this.update();
  }
  createAnalytics() {
    const googleAnalytics = document.createElement("script");
    googleAnalytics.onload = _ => {
      function gtag() {
        dataLayer.push(arguments);
      }
      window.dataLayer = window.dataLayer || [];
      gtag("js", new Date());
      gtag("config", "GOOGLE_ANALYTICS");
    };
    googleAnalytics.src = "https://www.googletagmanager.com/gtag/js?id=GOOGLE_ANALYTICS";
    document.body.appendChild(googleAnalytics);
  }
  createCanvas() {
    this.canvas = new components_Canvas__WEBPACK_IMPORTED_MODULE_10__["default"]({
      url: this.url
    });
  }
  createStats() {
    this.stats = new (stats_js__WEBPACK_IMPORTED_MODULE_5___default())();
    document.body.appendChild(this.stats.dom);
  }

  /**
   * Methods.
   */
  async onChange({
    push = true,
    url = null
  }) {
    if (this.isLoading || this.url === url) {
      return;
    }
    document.body.style.pointerEvents = "none";
    this.url = url;
    this.isLoading = true;
    const request = await window.fetch(url, {
      headers: {
        "X-Requested-With": "XMLHttpRequest"
      }
    });
    const response = await request.text();
    this.onRequest({
      push,
      response,
      url
    });
  }
  async onRequest({
    push,
    response,
    url
  }) {
    const html = document.createElement("div");
    html.innerHTML = response;
    const content = html.querySelector(".content");
    if (this.page) {
      await Promise.all([this.page.hide(content.dataset.template)]);
    }
    document.title = html.querySelector("title").textContent;
    if (push) {
      window.history.pushState({}, document.title, url);
    }
    this.content.innerHTML = content.innerHTML;
    this.content.dataset.template = content.dataset.template;
    this.template = content.dataset.template;
    this.page = this.pages.get(this.template);
    this.page.create();
    this.addLinksEventsListeners();
    await this.page.show();
    document.body.style.pointerEvents = "";
    this.isLoading = false;
  }

  /**
   * Loop.
   */
  update() {
    if (this.stats) {
      this.stats.begin();
    }
    if (this.page) {
      this.page.update();
    }
    if (this.canvas) {
      this.canvas.update(this);
    }
    if (this.stats) {
      this.stats.end();
    }
    window.requestAnimationFrame(this.update);
  }

  /**
   * Events.
   */
  onContextMenu(event) {
    event.preventDefault();
    event.stopPropagation();
    return false;
  }
  onPopState() {
    this.onChange({
      url: window.location.pathname,
      push: false
    });
  }
  onResize() {
    window.requestAnimationFrame(_ => {
      if (this.page) {
        this.page.onResize();
      }
      if (this.canvas) {
        this.canvas.onResize();
      }
    });
  }
  onKeyDown(event) {
    if (event.key === "Tab") {
      event.preventDefault();
    }
    if (event.key === "ArrowDown") {
      this.page.scroll.target += 100;
    } else if (event.key === "ArrowUp") {
      this.page.scroll.target -= 100;
    }
  }
  onFocusIn(event) {
    event.preventDefault();
  }
  onTouchDown(event) {
    event.stopPropagation();
    if (!classes_Detection__WEBPACK_IMPORTED_MODULE_7__["default"].isMobile() && event.target.tagName === "A") return;
    if (this.canvas && this.canvas.onTouchDown) {
      this.canvas.onTouchDown(event);
    }
    if (this.page && this.page.onTouchDown) {
      this.page.onTouchDown(event);
    }
  }
  onTouchMove(event) {
    event.stopPropagation();
    if (this.canvas && this.canvas.onTouchMove) {
      this.canvas.onTouchMove(event);
    }
    if (this.page && this.page.onTouchDown) {
      this.page.onTouchMove(event);
    }
  }
  onTouchUp(event) {
    event.stopPropagation();
    if (this.canvas && this.canvas.onTouchUp) {
      this.canvas.onTouchUp(event);
    }
    if (this.page && this.page.onTouchDown) {
      this.page.onTouchUp(event);
    }
  }
  onWheel(event) {
    if (this.page && this.page.onWheel) {
      this.page.onWheel(event);
    }
  }

  /**
   * Listeners.
   */
  addEventListeners() {
    window.addEventListener("popstate", this.onPopState, {
      passive: true
    });
    window.addEventListener("resize", this.onResize, {
      passive: true
    });
    window.addEventListener("mousedown", this.onTouchDown, {
      passive: true
    });
    window.addEventListener("mousemove", this.onTouchMove, {
      passive: true
    });
    window.addEventListener("mouseup", this.onTouchUp, {
      passive: true
    });
    window.addEventListener("touchstart", this.onTouchDown, {
      passive: true
    });
    window.addEventListener("touchmove", this.onTouchMove, {
      passive: true
    });
    window.addEventListener("touchend", this.onTouchUp, {
      passive: true
    });
    window.addEventListener("mousewheel", this.onWheel, {
      passive: true
    });
    window.addEventListener("wheel", this.onWheel, {
      passive: true
    });
    window.addEventListener("keydown", this.onKeyDown);
    window.addEventListener("focusin", this.onFocusIn);
    if (classes_Detection__WEBPACK_IMPORTED_MODULE_7__["default"].isMobile()) {
      window.oncontextmenu = this.onContextMenu;
    }
  }
  addLinksEventsListeners() {
    const links = document.querySelectorAll("a");
    lodash_each__WEBPACK_IMPORTED_MODULE_6___default()(links, link => {
      const isLocal = link.href.indexOf(window.location.origin) > -1;
      const isAnchor = link.href.indexOf("#") > -1;
      if (isLocal) {
        link.onclick = event => {
          event.preventDefault();
          if (!isAnchor) {
            this.onChange({
              url: link.href
            });
          }
        };
      } else if (link.href.indexOf("mailto") === -1 && link.href.indexOf("tel") === -1) {
        link.rel = "noopener";
        link.target = "_blank";
      }
    });
  }
}
const fontNeueHaas = new (fontfaceobserver_fontfaceobserver_standalone__WEBPACK_IMPORTED_MODULE_4___default())("Neue Haas Grotesk Regular");
Promise.all([fontNeueHaas.load()]).then(_ => {
  window.APP = new App();
}).catch(_ => {
  window.APP = new App();
});
console.log("%c Developed by David Faure - http://davidfaure.eu/", "background: #413A2A; color: #F2AB26;");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("e9ff680f6b32958e860e")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM7QUFFdEVrRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDc0MsWUFBWSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDL0JDLElBQUksQ0FBQ2xFLENBQUMsSUFBSTtFQUNUOUIsTUFBTSxDQUFDaUcsR0FBRyxHQUFHLElBQUlwRyxHQUFHLENBQUMsQ0FBQztBQUN4QixDQUFDLENBQUMsQ0FDRHFHLEtBQUssQ0FBQ3BFLENBQUMsSUFBSTtFQUNWOUIsTUFBTSxDQUFDaUcsR0FBRyxHQUFHLElBQUlwRyxHQUFHLENBQUMsQ0FBQztBQUN4QixDQUFDLENBQUM7QUFFSnNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUNULHFEQUFxRCxFQUNyRCxzQ0FDRixDQUFDOzs7Ozs7OztVQ3ZVRCIsInNvdXJjZXMiOlsid2VicGFjazovL25vZGUtdGVtcGxhdGUvLi9hcHAvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbm9kZS10ZW1wbGF0ZS93ZWJwYWNrL3J1bnRpbWUvZ2V0RnVsbEhhc2giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwidXRpbHMvcG9seWZpbGxcIlxuaW1wb3J0IFwidXRpbHMvc2Nyb2xsXCJcbmltcG9ydCBcInV0aWxzL3N3XCJcblxuaW1wb3J0IEF1dG9CaW5kIGZyb20gXCJhdXRvLWJpbmRcIlxuaW1wb3J0IEZvbnRGYWNlT2JzZXJ2ZXIgZnJvbSBcImZvbnRmYWNlb2JzZXJ2ZXIvZm9udGZhY2VvYnNlcnZlci5zdGFuZGFsb25lXCJcbmltcG9ydCBTdGF0cyBmcm9tIFwic3RhdHMuanNcIlxuXG5pbXBvcnQgZWFjaCBmcm9tIFwibG9kYXNoL2VhY2hcIlxuXG5pbXBvcnQgRGV0ZWN0aW9uIGZyb20gXCJjbGFzc2VzL0RldGVjdGlvblwiXG5cbmltcG9ydCBBYm91dCBmcm9tIFwicGFnZXMvQWJvdXRcIlxuaW1wb3J0IEhvbWUgZnJvbSBcInBhZ2VzL0hvbWVcIlxuXG5pbXBvcnQgQ2FudmFzIGZyb20gXCJjb21wb25lbnRzL0NhbnZhc1wiXG5pbXBvcnQgUHJlbG9hZGVyIGZyb20gXCJjb21wb25lbnRzL1ByZWxvYWRlclwiXG5cbmNsYXNzIEFwcCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGlmIChJU19ERVZFTE9QTUVOVCAmJiB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJmcHNcIikgPiAtMSkge1xuICAgICAgdGhpcy5jcmVhdGVTdGF0cygpXG4gICAgfVxuXG4gICAgQXV0b0JpbmQodGhpcylcblxuICAgIHRoaXMuY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKVxuICAgIHRoaXMudGVtcGxhdGUgPSB0aGlzLmNvbnRlbnQuZGF0YXNldC50ZW1wbGF0ZVxuXG4gICAgdGhpcy5jcmVhdGVQcmVsb2FkZXIoKVxuICAgIHRoaXMuY3JlYXRlQ2FudmFzKClcblxuICAgIHRoaXMucGFnZXMgPSBuZXcgTWFwKClcbiAgICB0aGlzLnBhZ2VzLnNldChcImFib3V0XCIsIG5ldyBBYm91dCgpKVxuICAgIHRoaXMucGFnZXMuc2V0KFwiaG9tZVwiLCBuZXcgSG9tZSgpKVxuXG4gICAgdGhpcy5wYWdlID0gdGhpcy5wYWdlcy5nZXQodGhpcy50ZW1wbGF0ZSlcbiAgICB0aGlzLnBhZ2UuY3JlYXRlKClcbiAgICB0aGlzLnBhZ2Uuc2hvdygpXG5cbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzKClcbiAgICB0aGlzLmFkZExpbmtzRXZlbnRzTGlzdGVuZXJzKClcbiAgfVxuXG4gIGNyZWF0ZVByZWxvYWRlcigpIHtcbiAgICB0aGlzLnByZWxvYWRlciA9IG5ldyBQcmVsb2FkZXIoKVxuICAgIHRoaXMucHJlbG9hZGVyLm9uKFwiY29tcGxldGVcIiwgdGhpcy5vblByZWxvYWRlZClcbiAgfVxuXG4gIG9uUHJlbG9hZGVkKCkge1xuICAgIHRoaXMub25SZXNpemUoKVxuXG4gICAgdGhpcy5jcmVhdGVBbmFseXRpY3MoKVxuXG4gICAgdGhpcy51cGRhdGUoKVxuICB9XG5cbiAgY3JlYXRlQW5hbHl0aWNzKCkge1xuICAgIGNvbnN0IGdvb2dsZUFuYWx5dGljcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIilcblxuICAgIGdvb2dsZUFuYWx5dGljcy5vbmxvYWQgPSBfID0+IHtcbiAgICAgIGZ1bmN0aW9uIGd0YWcoKSB7XG4gICAgICAgIGRhdGFMYXllci5wdXNoKGFyZ3VtZW50cylcbiAgICAgIH1cblxuICAgICAgd2luZG93LmRhdGFMYXllciA9IHdpbmRvdy5kYXRhTGF5ZXIgfHwgW11cblxuICAgICAgZ3RhZyhcImpzXCIsIG5ldyBEYXRlKCkpXG4gICAgICBndGFnKFwiY29uZmlnXCIsIFwiR09PR0xFX0FOQUxZVElDU1wiKVxuICAgIH1cblxuICAgIGdvb2dsZUFuYWx5dGljcy5zcmMgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9R09PR0xFX0FOQUxZVElDU1wiXG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGdvb2dsZUFuYWx5dGljcylcbiAgfVxuXG4gIGNyZWF0ZUNhbnZhcygpIHtcbiAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXMoe1xuICAgICAgdXJsOiB0aGlzLnVybFxuICAgIH0pXG4gIH1cblxuICBjcmVhdGVTdGF0cygpIHtcbiAgICB0aGlzLnN0YXRzID0gbmV3IFN0YXRzKClcblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5zdGF0cy5kb20pXG4gIH1cblxuICAvKipcbiAgICogTWV0aG9kcy5cbiAgICovXG4gIGFzeW5jIG9uQ2hhbmdlKHsgcHVzaCA9IHRydWUsIHVybCA9IG51bGwgfSkge1xuICAgIGlmICh0aGlzLmlzTG9hZGluZyB8fCB0aGlzLnVybCA9PT0gdXJsKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxuXG4gICAgdGhpcy51cmwgPSB1cmxcblxuICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZVxuXG4gICAgY29uc3QgcmVxdWVzdCA9IGF3YWl0IHdpbmRvdy5mZXRjaCh1cmwsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJYLVJlcXVlc3RlZC1XaXRoXCI6IFwiWE1MSHR0cFJlcXVlc3RcIlxuICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QudGV4dCgpXG5cbiAgICB0aGlzLm9uUmVxdWVzdCh7XG4gICAgICBwdXNoLFxuICAgICAgcmVzcG9uc2UsXG4gICAgICB1cmxcbiAgICB9KVxuICB9XG5cbiAgYXN5bmMgb25SZXF1ZXN0KHsgcHVzaCwgcmVzcG9uc2UsIHVybCB9KSB7XG4gICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcblxuICAgIGh0bWwuaW5uZXJIVE1MID0gcmVzcG9uc2VcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBodG1sLnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKVxuXG4gICAgaWYgKHRoaXMucGFnZSkge1xuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW3RoaXMucGFnZS5oaWRlKGNvbnRlbnQuZGF0YXNldC50ZW1wbGF0ZSldKVxuICAgIH1cblxuICAgIGRvY3VtZW50LnRpdGxlID0gaHRtbC5xdWVyeVNlbGVjdG9yKFwidGl0bGVcIikudGV4dENvbnRlbnRcblxuICAgIGlmIChwdXNoKSB7XG4gICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIGRvY3VtZW50LnRpdGxlLCB1cmwpXG4gICAgfVxuXG4gICAgdGhpcy5jb250ZW50LmlubmVySFRNTCA9IGNvbnRlbnQuaW5uZXJIVE1MXG4gICAgdGhpcy5jb250ZW50LmRhdGFzZXQudGVtcGxhdGUgPSBjb250ZW50LmRhdGFzZXQudGVtcGxhdGVcblxuICAgIHRoaXMudGVtcGxhdGUgPSBjb250ZW50LmRhdGFzZXQudGVtcGxhdGVcblxuICAgIHRoaXMucGFnZSA9IHRoaXMucGFnZXMuZ2V0KHRoaXMudGVtcGxhdGUpXG4gICAgdGhpcy5wYWdlLmNyZWF0ZSgpXG5cbiAgICB0aGlzLmFkZExpbmtzRXZlbnRzTGlzdGVuZXJzKClcblxuICAgIGF3YWl0IHRoaXMucGFnZS5zaG93KClcblxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiXCJcblxuICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2VcbiAgfVxuXG4gIC8qKlxuICAgKiBMb29wLlxuICAgKi9cbiAgdXBkYXRlKCkge1xuICAgIGlmICh0aGlzLnN0YXRzKSB7XG4gICAgICB0aGlzLnN0YXRzLmJlZ2luKClcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wYWdlKSB7XG4gICAgICB0aGlzLnBhZ2UudXBkYXRlKClcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jYW52YXMpIHtcbiAgICAgIHRoaXMuY2FudmFzLnVwZGF0ZSh0aGlzKVxuICAgIH1cblxuICAgIGlmICh0aGlzLnN0YXRzKSB7XG4gICAgICB0aGlzLnN0YXRzLmVuZCgpXG4gICAgfVxuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSlcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmVudHMuXG4gICAqL1xuICBvbkNvbnRleHRNZW51KGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG5cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIG9uUG9wU3RhdGUoKSB7XG4gICAgdGhpcy5vbkNoYW5nZSh7XG4gICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcbiAgICAgIHB1c2g6IGZhbHNlXG4gICAgfSlcbiAgfVxuXG4gIG9uUmVzaXplKCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoXyA9PiB7XG4gICAgICBpZiAodGhpcy5wYWdlKSB7XG4gICAgICAgIHRoaXMucGFnZS5vblJlc2l6ZSgpXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmNhbnZhcykge1xuICAgICAgICB0aGlzLmNhbnZhcy5vblJlc2l6ZSgpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIG9uS2V5RG93bihldmVudCkge1xuICAgIGlmIChldmVudC5rZXkgPT09IFwiVGFiXCIpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93RG93blwiKSB7XG4gICAgICB0aGlzLnBhZ2Uuc2Nyb2xsLnRhcmdldCArPSAxMDBcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd1VwXCIpIHtcbiAgICAgIHRoaXMucGFnZS5zY3JvbGwudGFyZ2V0IC09IDEwMFxuICAgIH1cbiAgfVxuXG4gIG9uRm9jdXNJbihldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgfVxuXG4gIG9uVG91Y2hEb3duKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcblxuICAgIGlmICghRGV0ZWN0aW9uLmlzTW9iaWxlKCkgJiYgZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT09IFwiQVwiKSByZXR1cm5cblxuICAgIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy5vblRvdWNoRG93bikge1xuICAgICAgdGhpcy5jYW52YXMub25Ub3VjaERvd24oZXZlbnQpXG4gICAgfVxuXG4gICAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2Uub25Ub3VjaERvd24pIHtcbiAgICAgIHRoaXMucGFnZS5vblRvdWNoRG93bihldmVudClcbiAgICB9XG4gIH1cblxuICBvblRvdWNoTW92ZShldmVudCkge1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG5cbiAgICBpZiAodGhpcy5jYW52YXMgJiYgdGhpcy5jYW52YXMub25Ub3VjaE1vdmUpIHtcbiAgICAgIHRoaXMuY2FudmFzLm9uVG91Y2hNb3ZlKGV2ZW50KVxuICAgIH1cblxuICAgIGlmICh0aGlzLnBhZ2UgJiYgdGhpcy5wYWdlLm9uVG91Y2hEb3duKSB7XG4gICAgICB0aGlzLnBhZ2Uub25Ub3VjaE1vdmUoZXZlbnQpXG4gICAgfVxuICB9XG5cbiAgb25Ub3VjaFVwKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcblxuICAgIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy5vblRvdWNoVXApIHtcbiAgICAgIHRoaXMuY2FudmFzLm9uVG91Y2hVcChldmVudClcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wYWdlICYmIHRoaXMucGFnZS5vblRvdWNoRG93bikge1xuICAgICAgdGhpcy5wYWdlLm9uVG91Y2hVcChldmVudClcbiAgICB9XG4gIH1cblxuICBvbldoZWVsKGV2ZW50KSB7XG4gICAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2Uub25XaGVlbCkge1xuICAgICAgdGhpcy5wYWdlLm9uV2hlZWwoZXZlbnQpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpc3RlbmVycy5cbiAgICovXG4gIGFkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgdGhpcy5vblBvcFN0YXRlLCB7IHBhc3NpdmU6IHRydWUgfSlcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLm9uUmVzaXplLCB7IHBhc3NpdmU6IHRydWUgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMub25Ub3VjaERvd24sIHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMub25Ub3VjaE1vdmUsIHsgcGFzc2l2ZTogdHJ1ZSB9KVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLm9uVG91Y2hVcCwgeyBwYXNzaXZlOiB0cnVlIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgdGhpcy5vblRvdWNoRG93biwgeyBwYXNzaXZlOiB0cnVlIH0pXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgdGhpcy5vblRvdWNoTW92ZSwgeyBwYXNzaXZlOiB0cnVlIH0pXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLm9uVG91Y2hVcCwgeyBwYXNzaXZlOiB0cnVlIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNld2hlZWxcIiwgdGhpcy5vbldoZWVsLCB7IHBhc3NpdmU6IHRydWUgfSlcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIHRoaXMub25XaGVlbCwgeyBwYXNzaXZlOiB0cnVlIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5vbktleURvd24pXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsIHRoaXMub25Gb2N1c0luKVxuXG4gICAgaWYgKERldGVjdGlvbi5pc01vYmlsZSgpKSB7XG4gICAgICB3aW5kb3cub25jb250ZXh0bWVudSA9IHRoaXMub25Db250ZXh0TWVudVxuICAgIH1cbiAgfVxuXG4gIGFkZExpbmtzRXZlbnRzTGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImFcIilcblxuICAgIGVhY2gobGlua3MsIGxpbmsgPT4ge1xuICAgICAgY29uc3QgaXNMb2NhbCA9IGxpbmsuaHJlZi5pbmRleE9mKHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pID4gLTFcbiAgICAgIGNvbnN0IGlzQW5jaG9yID0gbGluay5ocmVmLmluZGV4T2YoXCIjXCIpID4gLTFcblxuICAgICAgaWYgKGlzTG9jYWwpIHtcbiAgICAgICAgbGluay5vbmNsaWNrID0gZXZlbnQgPT4ge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcblxuICAgICAgICAgIGlmICghaXNBbmNob3IpIHtcbiAgICAgICAgICAgIHRoaXMub25DaGFuZ2Uoe1xuICAgICAgICAgICAgICB1cmw6IGxpbmsuaHJlZlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobGluay5ocmVmLmluZGV4T2YoXCJtYWlsdG9cIikgPT09IC0xICYmIGxpbmsuaHJlZi5pbmRleE9mKFwidGVsXCIpID09PSAtMSkge1xuICAgICAgICBsaW5rLnJlbCA9IFwibm9vcGVuZXJcIlxuICAgICAgICBsaW5rLnRhcmdldCA9IFwiX2JsYW5rXCJcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG5cbmNvbnN0IGZvbnROZXVlSGFhcyA9IG5ldyBGb250RmFjZU9ic2VydmVyKFwiTmV1ZSBIYWFzIEdyb3Rlc2sgUmVndWxhclwiKVxuXG5Qcm9taXNlLmFsbChbZm9udE5ldWVIYWFzLmxvYWQoKV0pXG4gIC50aGVuKF8gPT4ge1xuICAgIHdpbmRvdy5BUFAgPSBuZXcgQXBwKClcbiAgfSlcbiAgLmNhdGNoKF8gPT4ge1xuICAgIHdpbmRvdy5BUFAgPSBuZXcgQXBwKClcbiAgfSlcblxuY29uc29sZS5sb2coXG4gIFwiJWMgRGV2ZWxvcGVkIGJ5IERhdmlkIEZhdXJlIC0gaHR0cDovL2RhdmlkZmF1cmUuZXUvXCIsXG4gIFwiYmFja2dyb3VuZDogIzQxM0EyQTsgY29sb3I6ICNGMkFCMjY7XCJcbilcbiIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcImU5ZmY2ODBmNmIzMjk1OGU4NjBlXCIpIl0sIm5hbWVzIjpbIkF1dG9CaW5kIiwiRm9udEZhY2VPYnNlcnZlciIsIlN0YXRzIiwiZWFjaCIsIkRldGVjdGlvbiIsIkFib3V0IiwiSG9tZSIsIkNhbnZhcyIsIlByZWxvYWRlciIsIkFwcCIsImNvbnN0cnVjdG9yIiwiSVNfREVWRUxPUE1FTlQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImluZGV4T2YiLCJjcmVhdGVTdGF0cyIsImNvbnRlbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZW1wbGF0ZSIsImRhdGFzZXQiLCJjcmVhdGVQcmVsb2FkZXIiLCJjcmVhdGVDYW52YXMiLCJwYWdlcyIsIk1hcCIsInNldCIsInBhZ2UiLCJnZXQiLCJjcmVhdGUiLCJzaG93IiwiYWRkRXZlbnRMaXN0ZW5lcnMiLCJhZGRMaW5rc0V2ZW50c0xpc3RlbmVycyIsInByZWxvYWRlciIsIm9uIiwib25QcmVsb2FkZWQiLCJvblJlc2l6ZSIsImNyZWF0ZUFuYWx5dGljcyIsInVwZGF0ZSIsImdvb2dsZUFuYWx5dGljcyIsImNyZWF0ZUVsZW1lbnQiLCJvbmxvYWQiLCJfIiwiZ3RhZyIsImRhdGFMYXllciIsInB1c2giLCJhcmd1bWVudHMiLCJEYXRlIiwic3JjIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2FudmFzIiwidXJsIiwic3RhdHMiLCJkb20iLCJvbkNoYW5nZSIsImlzTG9hZGluZyIsInN0eWxlIiwicG9pbnRlckV2ZW50cyIsInJlcXVlc3QiLCJmZXRjaCIsImhlYWRlcnMiLCJyZXNwb25zZSIsInRleHQiLCJvblJlcXVlc3QiLCJodG1sIiwiaW5uZXJIVE1MIiwiUHJvbWlzZSIsImFsbCIsImhpZGUiLCJ0aXRsZSIsInRleHRDb250ZW50IiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImJlZ2luIiwiZW5kIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib25Db250ZXh0TWVudSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJvblBvcFN0YXRlIiwicGF0aG5hbWUiLCJvbktleURvd24iLCJrZXkiLCJzY3JvbGwiLCJ0YXJnZXQiLCJvbkZvY3VzSW4iLCJvblRvdWNoRG93biIsImlzTW9iaWxlIiwidGFnTmFtZSIsIm9uVG91Y2hNb3ZlIiwib25Ub3VjaFVwIiwib25XaGVlbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXNzaXZlIiwib25jb250ZXh0bWVudSIsImxpbmtzIiwicXVlcnlTZWxlY3RvckFsbCIsImxpbmsiLCJpc0xvY2FsIiwiaHJlZiIsIm9yaWdpbiIsImlzQW5jaG9yIiwib25jbGljayIsInJlbCIsImZvbnROZXVlSGFhcyIsImxvYWQiLCJ0aGVuIiwiQVBQIiwiY2F0Y2giLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==